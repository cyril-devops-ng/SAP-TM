*&---------------------------------------------------------------------*
*& Include ztm039_p_out_turn_new_evt
*&---------------------------------------------------------------------*

  " ---------------------------------------------------------------------
  " 01. Initialization
  " ---------------------------------------------------------------------
INITIALIZATION.
  " ---------------------------------------------------------------------
  " 10: Screen titles
  " ---------------------------------------------------------------------
  t1  = `Output Selection`.
  tta = `Action Selection`.

  " ---------------------------------------------------------------------
  " 02: At Selection-screen Output
  " ---------------------------------------------------------------------
AT SELECTION-SCREEN OUTPUT.
  IF p_r_fom = abap_true.
    hide_screen_fields 'ALV'.
    show_screen_fields 'FOM'.
    t1 = 'Form Print-Out Selection'.
  ELSE.
    hide_screen_fields 'FOM'.
    show_screen_fields 'ALV'.
    t1 = 'ALV Report Selection'.
  ENDIF.
  " ---------------------------------------------------------------------
  " 03. Start-of-selection
  " ---------------------------------------------------------------------
START-OF-SELECTION.
  IF p_r_fom = abap_true.
    " ---------------------------------------------------------------------
    " 10: Check forwarding quotation exists
    " ---------------------------------------------------------------------
    PERFORM check_fwq_exists.
    " ---------------------------------------------------------------------
    " 20: Check forwarding order exists for forwarding quotation
    " ---------------------------------------------------------------------
    PERFORM check_fwo_exists_for_fwq.
    " ---------------------------------------------------------------------
    " 30: Get fwq Items
    " ---------------------------------------------------------------------
    PERFORM retrieve_fwq_items.
    " ---------------------------------------------------------------------
    " 40: Get TRQ Execution Data
    " ---------------------------------------------------------------------
    PERFORM get_fwq_execution_data.
    " ---------------------------------------------------------------------
    " 50: Get FWO items
    " ---------------------------------------------------------------------
    PERFORM retrieve_fwo_items.
    " ---------------------------------------------------------------------
    " 60: Create Form Header
    " ---------------------------------------------------------------------
    PERFORM create_form_header CHANGING gs_header.
    " ---------------------------------------------------------------------
    " 70: Create form Items
    " ---------------------------------------------------------------------
    PERFORM create_form_items CHANGING gt_items.
    " ---------------------------------------------------------------------
    " 80: Display form
    " ---------------------------------------------------------------------
    PERFORM display_form.
  ENDIF.
  IF p_r_alv = abap_true.
    " ---------------------------------------------------------------------
    " 90: Display report
    " ---------------------------------------------------------------------
    CALL SCREEN lcl_otr=>report.
  ENDIF.
